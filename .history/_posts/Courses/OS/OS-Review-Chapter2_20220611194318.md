# Chapter2 进程与线程

## 2.1 进程与线程

### 2.1.1 进程的概念和特征

#### 进程的概念

&emsp;在多道程序环境下。允许多个程序并发执行。而如果不加任何约束，则整个过程会的很乱，会失去封闭性，还会对资源进行竞争，同步性也无法保证。因此，引入进程（Process），实现操作系统的**并发性和共享性**（操作系统的最基本的特性之二）
&emsp;为了管理好每个进程（包括其数据和程序），为之配置一个专门的数据结构，进程控制块（Process Control Block， PCB）。系统利用PCB来描述进程的基本情况和运行状态，进而控制和管理进程。也将程序段、相关数据段、PCB三部分的组合称为**进程实体**，（又称进程映像），其与进程的区别在于，进程是动态的，进程映像是静态的。
&emsp;由于PCB的引入，我们便可以将进程进行抽象化处理。我们创建进程，也就是创建进程实体中的PCB，而撤销进程，实质上就是撤销进程的PCB。因此可以看出，**PCB是进程存在的唯一标志**。

&emsp;从不同的角度，进程可以有不同的定义，如下

1. 进程是程序的一次执行过程
2. 进程是一个程序及其数据在处理机上顺序执行时所发生的活动
3. 进程是具有独立功能的程序在一个数据集合上运行的过程,是系统进程资源分配和调度的一个独立单位

#### 进程的特征

&emsp;进程是由多道程序的并发执行而引出的,和程序是两个截然不同的概念。。进程的基本特征如下：

1. 动态性。进程是程序的一次执行，有着创建、活动、暂停、终止等过程，具有一定的生命周期性。动态性是进程的**最基本特征**
2. 并发性。指多个进程实体同存于内存中，能在一段时间内同时运行。引入进程的目的是使进程能和其他进程并发执行。并发是进程和操作系统的重要特征。
3. 独立性。指进程实体是一个独立运运行，独立获得资源和独立接受调度的**基本单位**。在由于其和PCB之间的关系，**凡是为建立PCB的程序，都无法作为一个独立的单位参与运行**
4. 异步性。进程相互竞争，进程各按各的、不可预知的速度向前推进。异步性会导致不可预知的结果，因此需要OS配置相应的**进程同步机制**

#### 进程的状态与转换

&emsp;通常进程有5种状态

1. 运行态。正在处理机上运行
2. 就绪态。获得了除了处理机外的一切所需资源。一旦得到处理机  便可以立即运行。处于就绪态的进程一般很多，以队列的形式组织。称为就绪队列
3. 阻塞态，或等待态。进程正在等待别的事件而暂停运行。如等待某个资源解除别的进程对它的占用，或等待输入输出的完成。即使处理机空闲，该进程也不能运行。多个阻塞态的进程也会用队列组织起来，称为阻塞队列。
4. 创建态。进程正在被创建，尚未转到就绪态。创建进程的步骤
   * 申请一个空白PCB，并向其写入用于控制和管理进程的信息
   * 为该进程分配运行所需的资源
   * 把该进程转入就绪态并插入就绪队列。但如果进程所需的资源尚不能得到满足(如内存不足)，则创建工作无法完成，此时状态为创建态。
5. 结束态。进程正从系统中消失，可能是进程正常结束或其他原因退出运行。进程需要结束运行时，系统首先将该进程设置为结束态，然后进一步处理释放资源和回收等

前三个态是进程的基本状态。
状态间的转换如下：