---
title: Archive
layout: default
description: 文章分拣处
header-img: "img/tag-bg.jpg"
---

<!--
	 Credits: this page shamelessly borrowed a lot from:
	 https://github.com/kitian616/jekyll-TeXt-theme
-->
<!-- Page Header -->
{% include intro-header.html type='page'%}

<!-- Main Content -->
<div class="container">
	<div class="row">
		<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
			<!-- Order Selector -->
			<select class="sel-lang" onchange= "onOrderChange(this.options[this.options.selectedIndex].value)">
				<option value="0" selected> 标签 | TAG </option>
				<option value="1"> 系列 | SER </option>
			</select>

			<div class='tag'>
				<!-- Tags (as filter) -->
				<div id='tag_cloud' class="tags tags-sup js-tags">
					{% include archive-tags.html identifier="Tags" %}
				</div>
			</div>

			<div class='ser'>
				<!-- Tags (as filter) -->
				<div id='tag_cloud' class="tags tags-sup js-tags">
					{% include archive-tags.html identifier="Series" %}
				</div>
			</div>

			<!-- Article List -->
			<div class="mini-post-list js-result d-none">
				{%- assign _sorted_list = site.posts | group_by: 'date' -%}

				{%- for _article_group in _sorted_list -%}
					{%- assign _article_list = _article_group.items | sort: 'title' | reverse -%}
					{%- assign _out_loop_first = forloop.first -%}

					{%- for _article in _article_list -%}

						{%- assign _tags = '' -%}
						{%- for _tag in _article.tags -%}
							{%- assign _tag_encode = _tag | strip | url_encode -%}
							{%- if forloop.last -%}
								{%- assign _tags = _tags | append: _tag_encode -%}
							{%- else -%}
								{%- assign _tags = _tags | append: _tag_encode | append: ',' -%}
							{%- endif -%}
						{%- endfor -%}

						{% comment %} group by year {% endcomment %}
						{%- assign _currentdate = _article.date | date: '%Y' -%}
						{%- if _currentdate != _date -%}
							{%- unless _out_loop_first -%}</div></section>{%- endunless -%}
							<section>
								<span class="fa listing-seperator" data-toggle="collapse" data-target="#{{ _currentdate }}">
									<span class="tag-text">{{ _currentdate }}</span>
								</span>
								<div id="{{ _currentdate }}" class="collapse in">
								{%- assign _date = _currentdate -%}
						{%- endif -%}

						<div class="post-preview item" data-tags="{{ _tags }}">
							<a href="{{ _article.url | prepend: site.baseurl }}">
								<h2 class="post-title">
									{{ _article.title }}
								</h2>
								{% if _article.subtitle %}
									<h3 class="post-subtitle">
										{{ _article.subtitle }}
									</h3>
								{% endif %}
							</a>
							<hr>
						</div>
					{%- endfor -%}
					{%- if forloop.last -%}</div></section>{%- endif -%}
				{%- endfor -%}
			</div>
		</div>
	</div>
</div>

<!-- Selection -->
<script type="text/javascript">
    // get nodes
    var $tag = document.querySelector(".tag");
    var $ser = document.querySelector(".ser");
    var $select = document.querySelector("select");

    // Changes at v1.8.1: include order flag as a url query. This interop well with catalog hash anchors.
    function getOrder() { return new URLSearchParams(document.location.search).get("order") }

    function setOrder(newOrder) {
        var params = new URLSearchParams(document.location.search)
        params.set("order", newOrder)
        document.location.search = params.toString()  // refresh.
    }

    // handle render
    function _render() {
        var order = getOrder()
        // series
        if (order == "series") {
            $select.selectedIndex = 1;
            $ser.style.display = "block";
            $ser.classList.add("active");
            $tag.style.display = "none";
            $tag.classList.remove("active");
            // default to tag
        } else {
            $select.selectedIndex = 0;
            $tag.style.display = "block";
            $tag.classList.add("active");
            $ser.style.display = "none";
            $ser.classList.remove("active");
        }
        // interop with catalog
    }

    // handle select change
    function onOrderChange(index) {
        if (index == 0) {
            order = "tag"
        } else {
            order = "series"
        }
        setOrder(order)
    }

    // init
    _render();
</script>